#DROP DATABASE estagio;
CREATE DATABASE estagio;
USE estagio;

CREATE TABLE DIAS_SEMANA(
	id INT,
    dia VARCHAR(45),
    PRIMARY KEY (id));
    
INSERT INTO DIAS_SEMANA VALUES (1, "segunda-feira");
INSERT INTO DIAS_SEMANA VALUES (2, "terça-feira");
INSERT INTO DIAS_SEMANA VALUES (3, "quarta-feira");
INSERT INTO DIAS_SEMANA VALUES (4, "quinta-feira");
INSERT INTO DIAS_SEMANA VALUES (5, "sexta-feira");

CREATE TABLE ALUNO(
	id INT,
    nome VARCHAR(45),
    PRIMARY KEY (id));
    
INSERT INTO ALUNO VALUES (1, "AMANDA");
INSERT INTO ALUNO VALUES (2, "DYLAN");
INSERT INTO ALUNO VALUES (3, "DÉBORA");
INSERT INTO ALUNO VALUES (4, "CAMILA");
INSERT INTO ALUNO VALUES (5, "THIAGO");
INSERT INTO ALUNO VALUES (6, "MATHEUS");
INSERT INTO ALUNO VALUES (7, "ALLAN");
INSERT INTO ALUNO VALUES (8, "HEURACIO");
INSERT INTO ALUNO VALUES (9, "ANDRE");
INSERT INTO ALUNO VALUES (10, "JOSELAINE");
INSERT INTO ALUNO VALUES (11, "AUGUSTO");
INSERT INTO ALUNO VALUES (12, "ARNALDO");
INSERT INTO ALUNO VALUES (13, "NOELI");
INSERT INTO ALUNO VALUES (14, "NEIL");
INSERT INTO ALUNO VALUES (15, "GUSTAVO");

CREATE TABLE DISCIPLINA(
	id INT,
    nome VARCHAR(45),
    PRIMARY KEY (id));
    
INSERT INTO DISCIPLINA VALUES (1, "FISICA");
INSERT INTO DISCIPLINA VALUES (2, "MATEMATICA");
INSERT INTO DISCIPLINA VALUES (3, "QUIMICA");
INSERT INTO DISCIPLINA VALUES (4, "INGLES");
INSERT INTO DISCIPLINA VALUES (5, "PORTUGUES");
INSERT INTO DISCIPLINA VALUES (6, "FILOSOFIA");
INSERT INTO DISCIPLINA VALUES (7, "HISTÓRIA");

CREATE TABLE PROFESSOR(
	id INT,
    nome VARCHAR(45),
    PRIMARY KEY (id));
    
INSERT INTO PROFESSOR VALUES (1, "GREGORY");
INSERT INTO PROFESSOR VALUES (2, "JOAO PEDRO");
INSERT INTO PROFESSOR VALUES (3, "DÉBORA");
INSERT INTO PROFESSOR VALUES (4, "CRISTINA");
INSERT INTO PROFESSOR VALUES (5, "BRAULIO"); 

CREATE TABLE TURMA(
	id INT,
    DIAS_SEMANA_ID INT,
    horario VARCHAR(45),
    DISCIPLINA_ID INT,
    PROFESSOR_ID INT,
    ALUNO_ID INT,
    PRIMARY KEY (id),
    FOREIGN KEY (DIAS_SEMANA_ID) REFERENCES DIAS_SEMANA(id),
    FOREIGN KEY (DISCIPLINA_ID) REFERENCES DISCIPLINA(id),
    FOREIGN KEY (PROFESSOR_ID) REFERENCES PROFESSOR(id),
    FOREIGN KEY (ALUNO_ID) REFERENCES ALUNO(id));
    
INSERT INTO TURMA VALUES (1, 2, "10:00", 2, 1, 1);
INSERT INTO TURMA VALUES (2, 4, "10:00", 4, 2, 1);

INSERT INTO TURMA VALUES (3, 2, "10:00", 2, 1, 2);
INSERT INTO TURMA VALUES (4, 4, "10:00", 4, 1, 2);
INSERT INTO TURMA VALUES (5, 5, "10:00", 5, 1, 2);

INSERT INTO TURMA VALUES (6, 1, "10:00", 1, 2, 3);
INSERT INTO TURMA VALUES (7, 2, "10:00", 2, 1, 3);
INSERT INTO TURMA VALUES (8, 3, "10:00", 3, 4, 3);
INSERT INTO TURMA VALUES (9, 5, "10:00", 5, 1, 3);

INSERT INTO TURMA VALUES (10, 1, "10:00", 1, 2, 4);
INSERT INTO TURMA VALUES (11, 2, "10:00", 2, 1, 4);

INSERT INTO TURMA VALUES (12, 2, "10:00", 2, 1, 5);
INSERT INTO TURMA VALUES (13, 4, "10:00", 4, 3, 5);

INSERT INTO TURMA VALUES (14, 2, "10:00", 2, 1, 6);
INSERT INTO TURMA VALUES (15, 2, "10:00", 2, 1, 7);
INSERT INTO TURMA VALUES (16, 2, "10:00", 2, 1, 8);
INSERT INTO TURMA VALUES (17, 2, "10:00", 2, 1, 9);
INSERT INTO TURMA VALUES (18, 2, "10:00", 2, 1, 10);
INSERT INTO TURMA VALUES (19, 2, "10:00", 2, 1, 11);
INSERT INTO TURMA VALUES (20, 2, "10:00", 2, 1, 12);
INSERT INTO TURMA VALUES (21, 2, "10:00", 2, 1, 13);
INSERT INTO TURMA VALUES (22, 2, "10:00", 2, 1, 14);
INSERT INTO TURMA VALUES (23, 2, "10:00", 2, 1, 15);

#selecionando todas as turmas para ver como está a base:
#SELECT * FROM TURMA

#1. Buscar os nomes de todos os alunos que frequentam alguma turma do professor 'JOAO PEDRO'. OK!
#	AMANDA, DÉBORA E CAMILA
SELECT a.nome
	FROM ALUNO a, TURMA t, PROFESSOR p
	WHERE p.nome = 'JOAO PEDRO' 
    AND p.id = t.PROFESSOR_ID AND a.id = t.ALUNO_ID;

#2. Buscar os dias da semana que tenham aulas da disciplina 'MATEMATICA'. OK
# 	TERÇA-FEIRA
SELECT d.dia  
	FROM DIAS_SEMANA d, TURMA t, DISCIPLINA di
    WHERE (di.nome = 'MATEMATICA' 
    AND di.id = t.DISCIPLINA_ID AND d.id = t.DIAS_SEMANA_ID) GROUP BY dia;  # aqui poderia ter feito SELECT DISTINCT d.dia porém o tempo de busca em bases grandes é muito maior, portanto menos eficiente

#3. Buscar todos os alunos que frequentem aulas de 'MATEMATICA' e também 'FISICA'. OK!	
# 	DÉBORA E CAMILA
SELECT a.nome FROM ALUNO a, TURMA t, DISCIPLINA di
	WHERE DI.NOME = 'MATEMATICA' AND di.id = t.DISCIPLINA_ID AND a.id = ALUNO_ID
    AND a.nome IN (SELECT a.nome FROM ALUNO a, TURMA t, DISCIPLINA di
	WHERE di.nome = 'FISICA' AND di.id = t.DISCIPLINA_ID AND a.id = ALUNO_ID);
    
#4. Buscar as disciplinas que não tenham nenhuma turma.  OK!
#	FILOSOFIA E HISTÓRIA
SELECT di.nome
	FROM DISCIPLINA di
	WHERE di.id NOT IN (SELECT DISCIPLINA_ID FROM TURMA);

#5. Buscar os alunos que frequentem aulas de 'MATEMATICA' exceto os que frequentem 'QUIMICA'.
# 	OBSERVAÇÃO: RESPOSTA: AUSENCIA DA DÉBORA - OK
SELECT a.nome FROM ALUNO a, TURMA t, DISCsIPLINA di
	WHERE DI.NOME = 'MATEMATICA' AND di.id = t.DISCIPLINA_ID AND a.id = ALUNO_ID
	AND a.nome NOT IN (SELECT a.nome FROM ALUNO a, TURMA t, DISCIPLINA di
	WHERE di.nome = 'QUIMICA' AND di.id = t.DISCIPLINA_ID AND a.id = ALUNO_ID);